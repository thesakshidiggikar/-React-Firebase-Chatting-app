{"ast":null,"code":"import { refEqual, queryEqual, onSnapshot, getDocsFromServer, getDocsFromCache, getDocs, getDocFromServer, getDocFromCache, getDoc } from 'firebase/firestore';\nimport { useMemo, useReducer, useCallback, useRef, useEffect, useState } from 'react';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\nfunction __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\nfunction __generator(thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function sent() {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n}\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\nvar _assign = function __assign() {\n  _assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return _assign.apply(this, arguments);\n};\nvar defaultState = function defaultState(defaultValue) {\n  return {\n    loading: defaultValue === undefined || defaultValue === null,\n    value: defaultValue\n  };\n};\nvar reducer = function reducer() {\n  return function (state, action) {\n    switch (action.type) {\n      case 'error':\n        return _assign(_assign({}, state), {\n          error: action.error,\n          loading: false,\n          value: undefined\n        });\n      case 'reset':\n        return defaultState(action.defaultValue);\n      case 'value':\n        return _assign(_assign({}, state), {\n          error: undefined,\n          loading: false,\n          value: action.value\n        });\n      default:\n        return state;\n    }\n  };\n};\nvar useLoadingValue = function useLoadingValue(getDefaultValue) {\n  var defaultValue = getDefaultValue ? getDefaultValue() : undefined;\n  var _a = useReducer(reducer(), defaultState(defaultValue)),\n    state = _a[0],\n    dispatch = _a[1];\n  var reset = useCallback(function () {\n    var defaultValue = getDefaultValue ? getDefaultValue() : undefined;\n    dispatch({\n      type: 'reset',\n      defaultValue: defaultValue\n    });\n  }, [getDefaultValue]);\n  var setError = useCallback(function (error) {\n    dispatch({\n      type: 'error',\n      error: error\n    });\n  }, []);\n  var setValue = useCallback(function (value) {\n    dispatch({\n      type: 'value',\n      value: value\n    });\n  }, []);\n  return useMemo(function () {\n    return {\n      error: state.error,\n      loading: state.loading,\n      reset: reset,\n      setError: setError,\n      setValue: setValue,\n      value: state.value\n    };\n  }, [state.error, state.loading, reset, setError, setValue, state.value]);\n};\nvar useComparatorRef = function useComparatorRef(value, isEqual, onChange) {\n  var ref = useRef(value);\n  useEffect(function () {\n    if (!isEqual(value, ref.current)) {\n      ref.current = value;\n      if (onChange) {\n        onChange();\n      }\n    }\n  });\n  return ref;\n};\nvar useIsMounted = function useIsMounted() {\n  var _a = useState(true),\n    isMounted = _a[0],\n    setIsMounted = _a[1];\n  useEffect(function () {\n    return function () {\n      setIsMounted(false);\n    };\n  }, []);\n  return isMounted;\n};\nvar isRefEqual = function isRefEqual(v1, v2) {\n  var bothNull = !v1 && !v2;\n  var equal = !!v1 && !!v2 && refEqual(v1, v2);\n  return bothNull || equal;\n};\nvar useIsFirestoreRefEqual = function useIsFirestoreRefEqual(value, onChange) {\n  return useComparatorRef(value, isRefEqual, onChange);\n};\nvar isQueryEqual = function isQueryEqual(v1, v2) {\n  var bothNull = !v1 && !v2;\n  var equal = !!v1 && !!v2 && queryEqual(v1, v2);\n  return bothNull || equal;\n};\nvar useIsFirestoreQueryEqual = function useIsFirestoreQueryEqual(value, onChange) {\n  return useComparatorRef(value, isQueryEqual, onChange);\n};\nvar useCollection = function useCollection(query, options) {\n  var _a = useLoadingValue(),\n    error = _a.error,\n    loading = _a.loading,\n    reset = _a.reset,\n    setError = _a.setError,\n    setValue = _a.setValue,\n    value = _a.value;\n  var ref = useIsFirestoreQueryEqual(query, reset);\n  useEffect(function () {\n    if (!ref.current) {\n      setValue(undefined);\n      return;\n    }\n    var unsubscribe = (options === null || options === void 0 ? void 0 : options.snapshotListenOptions) ? onSnapshot(ref.current, options.snapshotListenOptions, setValue, setError) : onSnapshot(ref.current, setValue, setError);\n    return function () {\n      unsubscribe();\n    };\n  }, [ref.current]);\n  return [value, loading, error];\n};\nvar useCollectionOnce = function useCollectionOnce(query, options) {\n  var _a = useLoadingValue(),\n    error = _a.error,\n    loading = _a.loading,\n    reset = _a.reset,\n    setError = _a.setError,\n    setValue = _a.setValue,\n    value = _a.value;\n  var isMounted = useIsMounted();\n  var ref = useIsFirestoreQueryEqual(query, reset);\n  var loadData = useCallback(function (query, options) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var get, result, error_1;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (!query) {\n              setValue(undefined);\n              return [2 /*return*/];\n            }\n\n            get = getDocsFnFromGetOptions(options === null || options === void 0 ? void 0 : options.getOptions);\n            _a.label = 1;\n          case 1:\n            _a.trys.push([1, 3,, 4]);\n            return [4 /*yield*/, get(query)];\n          case 2:\n            result = _a.sent();\n            if (isMounted) {\n              setValue(result);\n            }\n            return [3 /*break*/, 4];\n          case 3:\n            error_1 = _a.sent();\n            if (isMounted) {\n              setError(error_1);\n            }\n            return [3 /*break*/, 4];\n          case 4:\n            return [2 /*return*/];\n        }\n      });\n    });\n  }, []);\n  var reloadData = useCallback(function () {\n    return loadData(ref.current, options);\n  }, [loadData, ref.current]);\n  useEffect(function () {\n    loadData(ref.current, options);\n  }, [ref.current]);\n  return [value, loading, error, reloadData];\n};\nvar useCollectionData = function useCollectionData(query, options) {\n  var _a = useCollection(query, options),\n    snapshots = _a[0],\n    loading = _a[1],\n    error = _a[2];\n  var values = getValuesFromSnapshots(snapshots, options === null || options === void 0 ? void 0 : options.snapshotOptions, options === null || options === void 0 ? void 0 : options.initialValue);\n  return [values, loading, error, snapshots];\n};\nvar useCollectionDataOnce = function useCollectionDataOnce(query, options) {\n  var _a = useCollectionOnce(query, options),\n    snapshots = _a[0],\n    loading = _a[1],\n    error = _a[2],\n    reloadData = _a[3];\n  var values = getValuesFromSnapshots(snapshots, options === null || options === void 0 ? void 0 : options.snapshotOptions, options === null || options === void 0 ? void 0 : options.initialValue);\n  return [values, loading, error, snapshots, reloadData];\n};\nvar getValuesFromSnapshots = function getValuesFromSnapshots(snapshots, options, initialValue) {\n  return useMemo(function () {\n    var _a;\n    return (_a = snapshots === null || snapshots === void 0 ? void 0 : snapshots.docs.map(function (doc) {\n      return doc.data(options);\n    })) !== null && _a !== void 0 ? _a : initialValue;\n  }, [snapshots, options]);\n};\nvar getDocsFnFromGetOptions = function getDocsFnFromGetOptions(_a) {\n  var _b = _a === void 0 ? {\n      source: 'default'\n    } : _a,\n    source = _b.source;\n  switch (source) {\n    default:\n    case 'default':\n      return getDocs;\n    case 'cache':\n      return getDocsFromCache;\n    case 'server':\n      return getDocsFromServer;\n  }\n};\nvar useDocument = function useDocument(docRef, options) {\n  var _a = useLoadingValue(),\n    error = _a.error,\n    loading = _a.loading,\n    reset = _a.reset,\n    setError = _a.setError,\n    setValue = _a.setValue,\n    value = _a.value;\n  var ref = useIsFirestoreRefEqual(docRef, reset);\n  useEffect(function () {\n    if (!ref.current) {\n      setValue(undefined);\n      return;\n    }\n    var unsubscribe = (options === null || options === void 0 ? void 0 : options.snapshotListenOptions) ? onSnapshot(ref.current, options.snapshotListenOptions, setValue, setError) : onSnapshot(ref.current, setValue, setError);\n    return function () {\n      unsubscribe();\n    };\n  }, [ref.current]);\n  return [value, loading, error];\n};\nvar useDocumentOnce = function useDocumentOnce(docRef, options) {\n  var _a = useLoadingValue(),\n    error = _a.error,\n    loading = _a.loading,\n    reset = _a.reset,\n    setError = _a.setError,\n    setValue = _a.setValue,\n    value = _a.value;\n  var isMounted = useIsMounted();\n  var ref = useIsFirestoreRefEqual(docRef, reset);\n  var loadData = useCallback(function (reference, options) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var get, result, error_1;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (!reference) {\n              setValue(undefined);\n              return [2 /*return*/];\n            }\n\n            get = getDocFnFromGetOptions(options === null || options === void 0 ? void 0 : options.getOptions);\n            _a.label = 1;\n          case 1:\n            _a.trys.push([1, 3,, 4]);\n            return [4 /*yield*/, get(reference)];\n          case 2:\n            result = _a.sent();\n            if (isMounted) {\n              setValue(result);\n            }\n            return [3 /*break*/, 4];\n          case 3:\n            error_1 = _a.sent();\n            if (isMounted) {\n              setError(error_1);\n            }\n            return [3 /*break*/, 4];\n          case 4:\n            return [2 /*return*/];\n        }\n      });\n    });\n  }, []);\n  var reloadData = useCallback(function () {\n    return loadData(ref.current, options);\n  }, [loadData, ref.current]);\n  useEffect(function () {\n    if (!ref.current) {\n      setValue(undefined);\n      return;\n    }\n    loadData(ref.current, options);\n  }, [ref.current]);\n  return [value, loading, error, reloadData];\n};\nvar useDocumentData = function useDocumentData(docRef, options) {\n  var _a = useDocument(docRef, options),\n    snapshot = _a[0],\n    loading = _a[1],\n    error = _a[2];\n  var value = getValueFromSnapshot(snapshot, options === null || options === void 0 ? void 0 : options.snapshotOptions, options === null || options === void 0 ? void 0 : options.initialValue);\n  return [value, loading, error, snapshot];\n};\nvar useDocumentDataOnce = function useDocumentDataOnce(docRef, options) {\n  var _a = useDocumentOnce(docRef, options),\n    snapshot = _a[0],\n    loading = _a[1],\n    error = _a[2],\n    reloadData = _a[3];\n  var value = getValueFromSnapshot(snapshot, options === null || options === void 0 ? void 0 : options.snapshotOptions, options === null || options === void 0 ? void 0 : options.initialValue);\n  return [value, loading, error, snapshot, reloadData];\n};\nvar getDocFnFromGetOptions = function getDocFnFromGetOptions(_a) {\n  var _b = _a === void 0 ? {\n      source: 'default'\n    } : _a,\n    source = _b.source;\n  switch (source) {\n    default:\n    case 'default':\n      return getDoc;\n    case 'cache':\n      return getDocFromCache;\n    case 'server':\n      return getDocFromServer;\n  }\n};\nvar getValueFromSnapshot = function getValueFromSnapshot(snapshot, options, initialValue) {\n  return useMemo(function () {\n    var _a;\n    return (_a = snapshot === null || snapshot === void 0 ? void 0 : snapshot.data(options)) !== null && _a !== void 0 ? _a : initialValue;\n  }, [snapshot, options, initialValue]);\n};\nexport { useCollection, useCollectionData, useCollectionDataOnce, useCollectionOnce, useDocument, useDocumentData, useDocumentDataOnce, useDocumentOnce };","map":null,"metadata":{},"sourceType":"module"}